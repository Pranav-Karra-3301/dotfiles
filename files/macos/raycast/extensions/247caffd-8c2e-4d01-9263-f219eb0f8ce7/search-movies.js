"use strict";var Se=Object.create;var H=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var Re=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty;var Te=(e,t)=>{for(var r in t)H(e,r,{get:t[r],enumerable:!0})},re=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Re(t))!Ae.call(e,a)&&a!==r&&H(e,a,{get:()=>t[a],enumerable:!(n=Ie(t,a))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?Se(Ee(e)):{},re(t||!e||!e.__esModule?H(r,"default",{value:e,enumerable:!0}):r,e)),Pe=e=>re(H({},"__esModule",{value:!0}),e);var qe={};Te(qe,{default:()=>ke});module.exports=Pe(qe);var O=require("react"),h=require("@raycast/api");var _=require("react");var X=require("@raycast/api");function Y(){let e=(0,X.getPreferenceValues)(),t=[];if(!e.primaryInstanceName||!e.primaryInstanceUrl||!e.primaryInstanceApiKey)throw new Error("Primary Radarr instance configuration is incomplete");return t.push({name:e.primaryInstanceName,url:e.primaryInstanceUrl.replace(/\/$/,""),apiKey:e.primaryInstanceApiKey,isDefault:!0}),e.enableSecondaryInstance&&e.secondaryInstanceName&&e.secondaryInstanceUrl&&e.secondaryInstanceApiKey&&t.push({name:e.secondaryInstanceName,url:e.secondaryInstanceUrl.replace(/\/$/,""),apiKey:e.secondaryInstanceApiKey,isDefault:!1}),t}function ne(){let e=(0,X.getPreferenceValues)(),t=Y();if(e.activeInstance==="secondary"&&e.enableSecondaryInstance&&t.length>1)return t[1];if(t.length>0)return t[0];throw new Error("No Radarr instances configured")}function ae(){let[e,t]=(0,_.useState)(null),[r,n]=(0,_.useState)(!0),a=(0,_.useCallback)(()=>{try{let c=ne();t(c)}catch(c){console.error("Failed to load default instance:",c),t(null)}finally{n(!1)}},[]);(0,_.useEffect)(()=>{a()},[a]);let l=(0,_.useCallback)(c=>{t(c)},[]),i=(0,_.useMemo)(()=>{try{return Y()}catch{return[]}},[]);return{currentInstance:e,isLoading:r,availableInstances:i,switchToInstance:l}}var d=q(require("react")),g=require("@raycast/api");var se=Object.prototype.hasOwnProperty;function J(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&J(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(se.call(e,r)&&++n&&!se.call(t,r)||!(r in t)||!J(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}var F=q(require("node:fs")),Q=q(require("node:path")),le=q(require("node:crypto"));var ue=require("react/jsx-runtime");function Ce(e){let t=(0,d.useRef)(e),r=(0,d.useRef)(0);return J(e,t.current)||(t.current=e,r.current+=1),(0,d.useMemo)(()=>t.current,[r.current])}function E(e){let t=(0,d.useRef)(e);return t.current=e,t}function Ue(e,t){let r=e instanceof Error?e.message:String(e);return(0,g.showToast)({style:g.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??ie(e),secondaryAction:t?.primaryAction?ie(e):void 0})}var ie=e=>{let t=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,F.readFileSync)((0,Q.join)(g.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let a=g.environment.isDevelopment||t,l=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(i){i.hide(),a?g.Clipboard.copy(l):(0,g.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${l}
\`\`\`
`)}`)}}};function _e(e,t,r){let n=(0,d.useRef)(0),[a,l]=(0,d.useState)({isLoading:!0}),i=E(e),c=E(r?.abortable),u=E(t||[]),f=E(r?.onError),o=E(r?.onData),$=E(r?.onWillExecute),I=E(r?.failureToastOptions),R=E(a.data),x=(0,d.useRef)(null),b=(0,d.useRef)({page:0}),s=(0,d.useRef)(!1),k=(0,d.useRef)(!0),U=(0,d.useRef)(50),v=(0,d.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),y=(0,d.useCallback)((...L)=>{let P=v();$.current?.(L),l(m=>({...m,isLoading:!0}));let N=Me(i.current)(...L);function V(m){return m.name=="AbortError"||P===n.current&&(f.current?f.current(m):g.environment.launchType!==g.LaunchType.Background&&Ue(m,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(D){D.hide(),x.current?.(...u.current||[])}},...I.current}),l({error:m,isLoading:!1})),m}return typeof N=="function"?(s.current=!0,N(b.current).then(({data:m,hasMore:D,cursor:xe})=>(P===n.current&&(b.current&&(b.current.cursor=xe,b.current.lastItem=m?.[m.length-1]),o.current&&o.current(m,b.current),D&&(U.current=m.length),k.current=D,l(ve=>b.current.page===0?{data:m,isLoading:!1}:{data:(ve.data||[])?.concat(m),isLoading:!1})),m),m=>(k.current=!1,V(m)))):(s.current=!1,N.then(m=>(P===n.current&&(o.current&&o.current(m),l({data:m,isLoading:!1})),m),V))},[o,f,u,i,l,x,$,b,I,v]);x.current=y;let A=(0,d.useCallback)(()=>{b.current={page:0};let L=u.current||[];return y(...L)},[y,u]),C=(0,d.useCallback)(async(L,P)=>{let N;try{if(P?.optimisticUpdate){v(),typeof P?.rollbackOnError!="function"&&P?.rollbackOnError!==!1&&(N=structuredClone(R.current?.value));let V=P.optimisticUpdate;l(m=>({...m,data:V(m.data)}))}return await L}catch(V){if(typeof P?.rollbackOnError=="function"){let m=P.rollbackOnError;l(D=>({...D,data:m(D.data)}))}else P?.optimisticUpdate&&P?.rollbackOnError!==!1&&l(m=>({...m,data:N}));throw V}finally{P?.shouldRevalidateAfter!==!1&&(g.environment.launchType===g.LaunchType.Background||g.environment.commandMode==="menu-bar"?await A():A())}},[A,R,l,v]),T=(0,d.useCallback)(()=>{b.current.page+=1;let L=u.current||[];y(...L)},[b,u,y]);(0,d.useEffect)(()=>{b.current={page:0},r?.execute!==!1?y(...t||[]):v()},[Ce([t,r?.execute,y]),c,b]),(0,d.useEffect)(()=>()=>{v()},[v]);let K=r?.execute!==!1?a.isLoading:!1,B={...a,isLoading:K},G=s.current?{pageSize:U.current,hasMore:k.current,onLoadMore:T}:void 0;return{...B,revalidate:A,mutate:C,pagination:G}}function Me(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function oe(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function Oe(e){return e instanceof URLSearchParams?e.toString():e}function fe(e,t=[]){function r(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=Oe(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,l=Object.prototype.toString.call(n),i=a.exec(l)?.[1]??"unknown:["+l+"]";i=i.toLowerCase();let c=null;if((c=t.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else t.push(n);if(Buffer.isBuffer(n))return r("buffer:"),r(n.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](n);else throw new Error('Unknown object type "'+i+'"');else{let u=Object.keys(n);u=u.sort(),oe(n)||u.splice(0,0,"prototype","__proto__","constructor"),r("object:"+u.length+":");let f=this;return u.forEach(function(o){f.dispatch(o),r(":"),f.dispatch(n[o]),r(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let l=this;if(r("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(u){l.dispatch(u)});return}let i=[],c=n.map(function(u){let f=Le(),o=t.slice();return fe(f,o).dispatch(u),i=i.concat(o.slice(t.length)),f.read().toString()});t=t.concat(i),c.sort(),this._array(c,!1)},_date:function(n){r("date:"+n.toJSON())},_symbol:function(n){r("symbol:"+n.toString())},_error:function(n){r("error:"+n.toString())},_boolean:function(n){r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(n){r("fn:"),oe(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){r("number:"+n.toString())},_xml:function(n){r("xml:"+n.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(n){r("regex:"+n.toString())},_uint8array:function(n){r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){r("url:"+n.toString())},_map:function(n){r("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){r("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(n){r("bigint:"+n.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function Le(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function De(e,t){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:t}function Fe(e,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function Z(e){let t=le.default.createHash("sha1");return fe(t).dispatch(e),t.digest("hex")}var Ne=Symbol("cache without namespace"),ce=new Map;function Ve(e,t,r){let n=r?.cacheNamespace||Ne,a=ce.get(n)||ce.set(n,new g.Cache({namespace:r?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let l=E(e),i=E(t),c=(0,d.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(l.current)}catch($){console.error("Could not get Cache data:",$);return}}),u=(0,d.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,Fe)}catch($){return console.warn("The cached data is corrupted",$),i.current}}else return i.current},[c,i]),f=E(u),o=(0,d.useCallback)($=>{let I=typeof $=="function"?$(f.current):$;if(typeof I>"u")a.set(l.current,"undefined");else{let R=JSON.stringify(I,De);a.set(l.current,R)}return I},[a,l,f]);return[u,o]}var z=Symbol();function ze(e,t,r){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:l,...i}=r||{},c=(0,d.useRef)(null),[u,f]=Ve(Z(t||[])+l,z,{cacheNamespace:Z(e)}),o=(0,d.useRef)(u!==z?u:n),$=(0,d.useRef)(void 0),{mutate:I,revalidate:R,...x}=_e(e,t||[],{...i,onData(v,y){$.current=y,i.onData&&i.onData(v,y),!(y&&y.page>0)&&(c.current="promise",o.current=v,f(v))}}),b,s=x.pagination;$.current&&$.current.page>0&&x.data?b=x.data:c.current==="promise"?b=o.current:a&&u!==z?(b=u,s&&(s.hasMore=!0,s.pageSize=u.length)):a&&u===z?b=o.current:u!==z?(b=u,s&&(s.hasMore=!0,s.pageSize=u.length)):b=n;let k=E(b),U=(0,d.useCallback)(async(v,y)=>{let A;try{if(y?.optimisticUpdate){typeof y?.rollbackOnError!="function"&&y?.rollbackOnError!==!1&&(A=structuredClone(k.current));let C=y.optimisticUpdate(k.current);c.current="cache",o.current=C,f(C)}return await I(v,{shouldRevalidateAfter:y?.shouldRevalidateAfter})}catch(C){if(typeof y?.rollbackOnError=="function"){let T=y.rollbackOnError(k.current);c.current="cache",o.current=T,f(T)}else y?.optimisticUpdate&&y?.rollbackOnError!==!1&&(c.current="cache",o.current=A,f(A));throw C}},[f,I,k,o,c]);return(0,d.useEffect)(()=>{u!==z&&(c.current="cache",o.current=u)},[u]),{data:b,isLoading:x.isLoading,error:x.error,mutate:$.current&&$.current.page>0?I:U,pagination:s,revalidate:R}}function We(e){if(e){let t=Ke(e);if(!t)return!1;if(t.subtype==="json"||t.suffix==="json"||t.suffix&&/\bjson\b/i.test(t.suffix)||t.subtype&&/\bjson\b/i.test(t.subtype))return!0}return!1}var je=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function Ke(e){let t=e.indexOf(";"),r=t!==-1?e.slice(0,t).trim():e.trim(),n=je.exec(r.toLowerCase().toLowerCase());if(!n)return;let a=n[1],l=n[2],i,c=l.lastIndexOf("+");return c!==-1&&(i=l.substring(c+1),l=l.substring(0,c)),{type:a,subtype:l,suffix:i}}async function Be(e){if(!e.ok)throw new Error(e.statusText);let t=e.headers.get("content-type");return t&&We(t)?await e.json():await e.text()}function Ge(e){return{data:e,hasMore:!1}}function de(e,t){let{parseResponse:r,mapResult:n,initialData:a,execute:l,keepPreviousData:i,onError:c,onData:u,onWillExecute:f,failureToastOptions:o,...$}=t||{},I={initialData:a,execute:l,keepPreviousData:i,onError:c,onData:u,onWillExecute:f,failureToastOptions:o},R=E(r||Be),x=E(n||Ge),b=(0,d.useRef)(null),s=(0,d.useRef)(null),k=typeof e=="function"?e({page:0}):void 0;(!b.current||typeof s.current>"u"||s.current!==k)&&(b.current=e),s.current=k;let U=(0,d.useRef)(null),v=(0,d.useCallback)((C,T)=>async K=>{let B=await fetch(C(K),{signal:U.current?.signal,...T}),G=await R.current(B);return x.current?.(G)},[R,x]),y=(0,d.useCallback)(async(C,T)=>{let K=await fetch(C,{signal:U.current?.signal,...T}),B=await R.current(K);return x.current(B)?.data},[R,x]),A=(0,d.useMemo)(()=>s.current?v:y,[s,y,v]);return ze(A,[b.current,$],{...I,internal_cacheKeySuffix:s.current+Z(x.current)+Z(R.current),abortable:U})}var M=require("@raycast/api");function He(e,t,r){let n=!!(e?.url&&e?.apiKey)&&r?.execute!==!1,a=e?.url?`${e.url}/api/v3${t}`:"",{data:l,error:i,isLoading:c,mutate:u}=de(a,{headers:{"X-Api-Key":e?.apiKey||"","Content-Type":"application/json"},execute:n,onError:f=>{console.error(`Radarr API Error (${e?.name||"Unknown"}):`,f),(0,M.showToast)({style:M.Toast.Style.Failure,title:"Radarr Error",message:`Failed to connect to ${e?.name||"Radarr"}: ${f.message}`}),r?.onError?.(f)},onData:r?.onData});return{data:l,error:i,isLoading:c,mutate:u}}function he(e){return He(e,"/movie")}async function ee(e,t){if(!e?.url||!e?.apiKey)throw new Error("Invalid Radarr instance configuration");try{let r=`${e.url}/api/v3/movie/lookup?term=${encodeURIComponent(t)}`,n=await fetch(r,{headers:{"X-Api-Key":e.apiKey,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);let a=await n.json();return Array.isArray(a)?a:[]}catch(r){return console.error("Movie search error:",r),(0,M.showToast)({style:M.Toast.Style.Failure,title:"Search Failed",message:`Failed to search movies: ${r instanceof Error?r.message:"Unknown error"}`}),[]}}async function pe(e,t,r,n,a=!0,l=!0){if(!e?.url||!e?.apiKey)throw new Error("Invalid Radarr instance configuration");try{let i=`${e.url}/api/v3/movie`,c={title:t.title,originalTitle:t.originalTitle,sortTitle:t.sortTitle,status:t.status,overview:t.overview,inCinemas:t.inCinemas,images:t.images,website:t.website,year:t.year,runtime:t.runtime,imdbId:t.imdbId,tmdbId:t.tmdbId,genres:t.genres,ratings:t.ratings,qualityProfileId:r,rootFolderPath:n,monitored:a,addOptions:{searchForMovie:l}},u=await fetch(i,{method:"POST",headers:{"X-Api-Key":e.apiKey,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let o=await u.text();throw new Error(`HTTP ${u.status}: ${o}`)}let f=await u.json();return(0,M.showToast)({style:M.Toast.Style.Success,title:"Movie Added",message:`${t.title} (${t.year}) added to ${e.name}`}),f}catch(i){throw console.error("Add movie error:",i),(0,M.showToast)({style:M.Toast.Style.Failure,title:"Failed to Add Movie",message:`Could not add ${t.title}: ${i instanceof Error?i.message:"Unknown error"}`}),i}}async function me(e){if(!e?.url||!e?.apiKey)throw new Error("Invalid Radarr instance configuration");try{let t=`${e.url}/api/v3/rootfolder`,r=await fetch(t,{headers:{"X-Api-Key":e.apiKey,"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return(await r.json()).map(a=>({path:a.path,id:a.id}))}catch(t){return console.error("Failed to get root folders:",t),[]}}async function ge(e){if(!e?.url||!e?.apiKey)throw new Error("Invalid Radarr instance configuration");try{let t=`${e.url}/api/v3/qualityprofile`,r=await fetch(t,{headers:{"X-Api-Key":e.apiKey,"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return(await r.json()).map(a=>({name:a.name,id:a.id}))}catch(t){return console.error("Failed to get quality profiles:",t),[]}}function W(e){return`${e.title} (${e.year})`}function be(e){let t=e.images?.find(r=>r.coverType==="poster");return t?.remoteUrl||t?.url}function ye(e){let t=e.ratings;if(!t)return"";let r=[];return t.imdb?.value&&r.push(`IMDb: ${t.imdb.value.toFixed(1)}/10`),t.tmdb?.value&&r.push(`TMDB: ${t.tmdb.value.toFixed(1)}/10`),t.rottenTomatoes?.value&&r.push(`RT: ${t.rottenTomatoes.value}%`),r.join(" \u2022 ")}function $e(e,t=100){return e.length<=t?e:e.substring(0,t-3)+"..."}function we(e){return!e||e.length===0?"":e.slice(0,3).join(", ")}var j=require("react"),p=require("@raycast/api");var S=require("react/jsx-runtime");function te({movie:e,instance:t}){let[r,n]=(0,j.useState)([]),[a,l]=(0,j.useState)([]),[i,c]=(0,j.useState)(!0);(0,j.useEffect)(()=>{(async()=>{try{let[o,$]=await Promise.all([me(t),ge(t)]);n(o),l($),o.length===0&&(0,p.showToast)({style:p.Toast.Style.Failure,title:"No Root Folders",message:"Please configure root folders in Radarr first"}),$.length===0&&(0,p.showToast)({style:p.Toast.Style.Failure,title:"No Quality Profiles",message:"Please configure quality profiles in Radarr first"})}catch{(0,p.showToast)({style:p.Toast.Style.Failure,title:"Loading Error",message:"Unable to load configuration options"})}finally{c(!1)}})()},[t]);let u=async f=>{try{await pe(t,e,parseInt(f.qualityProfileId),f.rootFolderPath,f.monitored,f.searchOnAdd),(0,p.popToRoot)()}catch(o){console.error("Add movie error:",o),(0,p.showToast)({style:p.Toast.Style.Failure,title:"Failed to Add Movie",message:o instanceof Error?o.message:"Unknown error occurred"})}};return i?(0,S.jsx)(p.Form,{isLoading:!0}):r.length===0||a.length===0?(0,S.jsx)(p.Form,{actions:(0,S.jsx)(p.ActionPanel,{children:(0,S.jsx)(p.Action,{title:"Back",onAction:p.popToRoot})}),children:(0,S.jsx)(p.Form.Description,{text:"Incomplete configuration. Please check your Radarr settings."})}):(0,S.jsxs)(p.Form,{navigationTitle:`Add: ${W(e)}`,actions:(0,S.jsxs)(p.ActionPanel,{children:[(0,S.jsx)(p.Action.SubmitForm,{title:"Add Movie",onSubmit:u}),(0,S.jsx)(p.Action,{title:"Cancel",onAction:p.popToRoot})]}),children:[(0,S.jsx)(p.Form.Description,{text:`Configure settings to add "${W(e)}" to your Radarr collection`}),(0,S.jsx)(p.Form.Dropdown,{id:"qualityProfileId",title:"Quality Profile",defaultValue:a[0]?.id.toString(),children:a.map(f=>(0,S.jsx)(p.Form.Dropdown.Item,{value:f.id.toString(),title:f.name},f.id))}),(0,S.jsx)(p.Form.Dropdown,{id:"rootFolderPath",title:"Root Folder",defaultValue:r[0]?.path,children:r.map(f=>(0,S.jsx)(p.Form.Dropdown.Item,{value:f.path,title:f.path},f.id))}),(0,S.jsx)(p.Form.Checkbox,{id:"monitored",label:"Monitor this movie",defaultValue:!0,info:"If enabled, Radarr will automatically monitor for new releases of this movie"}),(0,S.jsx)(p.Form.Checkbox,{id:"searchOnAdd",label:"Search immediately",defaultValue:!0,info:"If enabled, Radarr will immediately search for this movie after adding"})]})}var w=require("react/jsx-runtime");function ke(e){let t=e.arguments.query??"",[r,n]=(0,O.useState)(t),[a,l]=(0,O.useState)([]),[i,c]=(0,O.useState)(!1),[u,f]=(0,O.useState)(new Set),{currentInstance:o,isLoading:$,availableInstances:I,switchToInstance:R}=ae(),{data:x}=he(o);(0,O.useEffect)(()=>{if(x){let s=new Set((x||[]).map(k=>k.tmdbId));f(s)}},[x,o]),(0,O.useEffect)(()=>{e.arguments.query&&e.arguments.query.trim()&&o?.url&&o?.apiKey&&(c(!0),ee(o,e.arguments.query).then(s=>l(s)).catch(s=>{console.error("Initial search error:",s),l([])}).finally(()=>c(!1)))},[e.arguments.query,o?.url,o?.apiKey]),(0,O.useEffect)(()=>{let s=setTimeout(()=>{if(!r.trim()||!o?.url||!o?.apiKey){l([]);return}c(!0),ee(o,r).then(k=>l(k)).catch(k=>{console.error("Search error:",k),l([])}).finally(()=>c(!1))},500);return()=>clearTimeout(s)},[r,o]);let b=s=>{let k=be(s),U=ye(s),v=we(s.genres),y=s.overview?$e(s.overview,150):"No overview available",A=u.has(s.tmdbId),C=[...A?[{icon:h.Icon.Check,tooltip:"Already in library"}]:[]];return(0,w.jsx)(h.List.Item,{icon:k||h.Icon.Video,title:W(s),accessories:C,detail:(0,w.jsx)(h.List.Item.Detail,{markdown:`# ${W(s)}

${k?`<img src="${k}" alt="Poster" width="200" />`:""}

## Overview
${y}

## Details
- **Runtime:** ${s.runtime?`${s.runtime} minutes`:"Unknown"}
- **Status:** ${s.status}
- **Genres:** ${v||"Not specified"}
- **Studio:** ${s.studio||"Not specified"}
${U?`- **Ratings:** ${U}`:""}
${s.imdbId?`- **IMDb:** [${s.imdbId}](https://imdb.com/title/${s.imdbId})`:""}
${s.website?`- **Website:** [${s.website}](${s.website})`:""}

## Release Information
${s.inCinemas?`- **In Cinemas:** ${new Date(s.inCinemas).toDateString()}`:""}
${s.certification?`- **Certification:** ${s.certification}`:""}`}),actions:(0,w.jsxs)(h.ActionPanel,{children:[(0,w.jsxs)(h.ActionPanel.Section,{children:[A?(0,w.jsx)(h.Action.OpenInBrowser,{title:"Open in Radarr",url:`${o?.url}/movie/${s.tmdbId}`,icon:h.Icon.Globe}):o?(0,w.jsx)(h.Action.Push,{title:"Configure & Add",icon:h.Icon.Plus,target:(0,w.jsx)(te,{movie:s,instance:o})}):null,s.imdbId&&(0,w.jsx)(h.Action.OpenInBrowser,{title:"Open in Imdb",url:`https://imdb.com/title/${s.imdbId}`,icon:h.Icon.Globe}),s.tmdbId&&(0,w.jsx)(h.Action.OpenInBrowser,{title:"Open in Tmdb",url:`https://themoviedb.org/movie/${s.tmdbId}`,icon:h.Icon.Globe}),s.title&&(0,w.jsx)(h.Action.OpenInBrowser,{title:"Search in Tvdb",url:`https://www.thetvdb.com/search?query=${encodeURIComponent(s.title)}`,icon:h.Icon.Globe})]}),I.length>1&&(0,w.jsxs)(h.ActionPanel.Section,{title:"Instance",children:[I.map(T=>(0,w.jsx)(h.Action,{title:`Switch to ${T.name}`,icon:o?.name===T.name?h.Icon.Check:h.Icon.Circle,onAction:()=>R(T)},T.name)),(0,w.jsx)(h.Action.Open,{title:"Open Preferences",target:"raycast://extensions/preferences",icon:h.Icon.Gear})]})]})},s.tmdbId)};return $?(0,w.jsx)(h.List,{isLoading:!0}):I.length===0?(0,w.jsx)(h.List,{children:(0,w.jsx)(h.List.EmptyView,{title:"No Radarr Instances Configured",description:"Please configure your Radarr instances in preferences",icon:h.Icon.ExclamationMark,actions:(0,w.jsx)(h.ActionPanel,{children:(0,w.jsx)(h.Action.Open,{title:"Open Preferences",target:"raycast://extensions/preferences",icon:h.Icon.Gear})})})}):(0,w.jsxs)(h.List,{isLoading:i,onSearchTextChange:s=>n(s||""),searchText:r,searchBarPlaceholder:`Search movies on ${o?.name||"Radarr"}...`,throttle:!0,isShowingDetail:!0,children:[(0,w.jsx)(h.List.EmptyView,{title:r.trim()?"No Results Found":"Start Typing to Search",description:r.trim()?`No movies found for "${r}"`:"Enter a movie title to begin searching",icon:r.trim()?h.Icon.MagnifyingGlass:h.Icon.Video}),(a||[]).map(b)]},`search-${o?.name||"default"}`)}
